## https
主要作用:
- 对数据进行加密,建立一个信息安全通道,来保证传输过程的数据安全
- 对网站服务器进行真实身份认证

使用原因:
- http明文通信内容可能被窃听
- http协议无法证明报文的完整性,可能被篡改
- http不验证通信方的身份,有可能遭遇伪装

https优势
- 数据隐私性: 内容经过对称加密,每一个连接生成一个唯一密钥
- 数据完整性: 内容传输经过完整性校验
- 身份认证: 第三方无法伪造服务端(客户端)身份

### https如何解决上述问题
https并不是应用层协议,只是http通信接口部分用SSL/TLS协议代替而已。

https协议主要功能基本都依赖于 TLS/SSL 协议, TLS/SSL 的功能实现主要依赖于三类基本算法: 散列函数、对称加密和非对称加密, 其利用非对称加密实现身份认证和密钥协商,对称加密算法采用协商的密钥对称加密,基于散列函数验证信息的完整性

#### 1. 解决内容可能被窃听的问题---加密

- 对称加密: 这种方法加密和解密同用一个密钥。加密和解密都会用到密钥。没有密钥无法对密码解密,但是任何人有了密钥就能解密了。但是如何让两方知道密钥, 因为一旦密钥被截获就没有加密的意义了
- 非对称加密: 公开密钥加密使用一对非对称的密钥。一把叫做私有密钥,另一把叫做公开密钥。创建连接时只需要交换公钥,随后一方发送数据使用另一方的公钥加密传输,对方收到加密信息之后再用自己的私钥进行解密。但是这种方式有缺点:
   - 公钥不包含服务器信息,使用非对称加密算法无法保证服务器身份合法性,存在中间人攻击风险,服务器发送客户端公钥传送过程中可能会中间人截获并且篡改
   - 使用非对称加密在数据加密解密过程中需要消耗时间,降低数据传输效率
- 对称加密+非对称加密(https采用这种方式): 先使用非对称加密获取对称加密的密钥,之后通信过程中使用对称加密的密钥

#### 2. 解决报文可能遭篡改问题--数字签名

网络中需要很多中间节点,虽然数据无法被解密,但是可能被篡改,那么如何校验数据的完整性呢？那就可以校验数字签名

数字签名有两种功效
- 确定消息确实是发送方签名并发出来的,因为别人假冒不了发送方的签名。
- 数字签名能确定消息的完整性,证明数据是否未被篡改过

数字签名生成:

将一段文本用Hash函数生成消息摘要,然后用发送者的公钥加密生成数字签名,和原文一起传送给接受者。

校验数字签名:

接受者用自己的私钥解密消息,然后用HASH函数对收到的原文产生一个摘要信息,将这个信息和上一次得到的摘要信息对比。如果相同,说明是完整的,在传输过程中没有被修改,否则说明信息被修改过,所以数字签名可以验证消息的完整性。

#### 3. 解决对方身份可能被伪装的问题---数字证书
数字证书认证机构处于客户端和服务器双方都可信赖的第三方机构的立场上

流程:
- 服务器的运营人员向第三方机构CA提交公钥、组织信息、个人信息(域名)等信息并申请认证;
- CA通过线上、线下等多种手段验证申请者提供信息的真实性, 如组织是否存在、企业是否合法,是否拥有域名的所有权等;
- 如果信息审核通过,CA回向申请者签发认证文件-证书。证书包含以下信息: 申请者公钥、申请者组织信息和个人信息、签发机构CA的信息、有效时间、证书序列号等信息的明文,同时包含一个签名。其签名的产生算法: 首先, 使用散列函数计算公开明文信息的信息摘要,然后采用CA私钥对信息摘要进行加密,密文即是签名;
- 客户端向服务器发送请求,服务器返回证书
- 客户端读取证书中的相关的明文信息, 采用相同散列函数计算得到信息摘要,然后利用对应CA公钥解密签名数据,对比证书的信息摘要,如果一致,可以确认证书的合法性
- 客户端还会验证证书相关的域名信息、有效时间信息等;客户端会内置信任CA的证书信息,如果CA不被信任,会判定为非法
